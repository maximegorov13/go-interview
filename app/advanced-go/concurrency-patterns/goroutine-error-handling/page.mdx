# Обработка ошибок в горутинах


Для безопасной передачи ошибок из горутин, которые не могут возвращать значение напрямую.

Ошибки отправляются в отдельный канал и централизованно обрабатываются.

```go showLineNumbers filename="main.go"
package main

import (
	"errors"
	"fmt"
	"sync"
)

// Пример: обработка ошибок в горутинах через канал.
// Идея: горутины не могут возвращать ошибку напрямую, поэтому шлем ее в errCh.
func worker(id int, in <-chan int, errCh chan<- error, wg *sync.WaitGroup) {
	defer wg.Done()
	for n := range in {
		if n < 0 {
			errCh <- fmt.Errorf("worker %d: %w", id, errors.New("negative input"))
			return
		}
		_ = n * n
	}
}

func main() {
	inputs := []int{2, 4, -1, 3}
	jobs := make(chan int)
	errCh := make(chan error, 2)

	var wg sync.WaitGroup
	for i := 1; i <= 2; i++ {
		wg.Add(1)
		go worker(i, jobs, errCh, &wg)
	}

	go func() {
		for _, v := range inputs {
			jobs <- v
		}
		close(jobs)
	}()

	go func() {
		wg.Wait()
		close(errCh)
	}()

	for err := range errCh {
		fmt.Println("error:", err)
	}
}
```
