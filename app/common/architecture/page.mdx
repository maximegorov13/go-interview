# Architecture/Microservice

## Архитектурные слои в приложениях

### 1. Слой презентации (Presentation Layer)

**Назначение:** Обработка входящих HTTP-запросов, валидация данных, преобразование в структуры бизнес-логики.

- **HTTP-обработчик (handler):** Обрабатывает запросы и передаёт их в бизнес-слой.
- **Валидация входных данных:** Проверка обязательных полей, форматов данных.
- **Преобразование запроса:** Преобразование входных данных в структуры бизнес-логики.

### 2. Слой бизнес-логики (Business Logic Layer)

**Назначение:** Основные бизнес-процессы, правила, валидации.

- **Сервис бронирования (Booking Service):** Выполняет операции по бронированию.
- **Бизнес-правила и валидация:** Обрабатывает сложные условия и выполняет операции с данными.

### 3. Слой доступа к данным (Data Access Layer)

**Назначение:** Управление данными и взаимодействие с базами данных.

- **Репозиторий бронирований (Booking Repository):** Запросы к базе данных (CRUD).
- **Взаимодействие с базой данных:** Управление хранилищем через SQL-запросы или ORM.

### 4. Слой моделей данных (Data Models Layer)

**Назначение:** Описание структур данных для приложения.

- **Структуры данных:** Описание сущностей, например, объектов бронирования.
- **DTO (Data Transfer Objects):** Используются для передачи данных между слоями или сервисами.

### 5. Слой конфигурации (Configuration Layer)

**Назначение:** Управление настройками приложения.

- **Настройки приложения:** Переменные окружения, файлы конфигурации.
- **Инициализация зависимостей:** Создание подключения к базам данных, логгирование, настройка API.

## Критерии плохой архитектуры

### 1. Жёсткость

**Определение:**

Система плохо адаптируется к изменениям. Любое небольшое изменение требует изменений в нескольких местах кода.

**Пример:**

Если структура данных используется сразу в нескольких слоях, то её изменение потребует переработки всего приложения.

**Решение:**

Используйте DTO и интерфейсы между слоями для уменьшения зависимости.

### 2. Неподвижность

**Определение:**

Сложность рефакторинга из-за плохого разделения модулей или отсутствия модульности.

**Пример:**

Если бизнес-логика зависит от базы данных, замена БД потребует изменений везде.

**Решение:**

Используйте интерфейсы, абстрагируя логику от конкретных реализаций.

### 3. Вязкость

**Определение:**

Избыточная централизация или, наоборот, децентрализация логики между модулями.

**Пример:**

В Go это приводит к циклическим импортам. Например, если сервисы обмениваются данными без DTO.

**Решение:**

Следуйте принципу единственной ответственности (SRP) и разделяйте модули осмысленно.

### 4. Излишняя повторяемость

**Определение:**

Копирование кода вместо использования общих модулей.

**Пример:**

Частое дублирование бизнес-логики в нескольких местах.

**Решение:**

Создавайте общие библиотеки или пакеты для многократного использования.

## Монолитная vs Микросервисная архитектура

| **Критерий**           | **Монолитная архитектура**              | **Микросервисная архитектура**          |
| ---------------------- | --------------------------------------- | --------------------------------------- |
| **Структура**          | Единое приложение с общей кодовой базой | Набор независимых сервисов              |
| **Деплой**             | Деплой всего приложения целиком         | Независимый деплой каждого сервиса      |
| **Масштабирование**    | Масштабирование всей системы            | Масштабирование отдельных сервисов      |
| **Тестирование**       | Тестирование всей системы               | Тестирование отдельных сервисов         |
| **Отказоустойчивость** | Сбой ломает всё приложение              | Сбой одного сервиса не влияет на другие |
| **Обновления**         | Требует пересборки всего приложения     | Обновление отдельных компонентов        |
| **Управление данными** | Единая база данных                      | Разные базы данных в каждом сервисе     |
| **Зависимости**        | Жёстко связанные модули                 | Минимальная связанность модулей         |
| **DevOps**             | Простое управление CI/CD                | Сложная DevOps инфраструктура           |
| **Коммуникации**       | Вызовы функций в приложении             | Сетевые вызовы (HTTP, gRPC, Kafka)      |

### **Плюсы и минусы архитектур**

#### Монолитная архитектура

**Плюсы:**

- Простота разработки и поддержки на старте.
- Меньшие затраты на DevOps.
- Единая база данных.
- Легкое развертывание CI/CD.

**Минусы:**

- Сложное масштабирование.
- Долгое тестирование и деплой.
- Зависимость модулей.
- Один сбой ломает всё приложение.

#### Микросервисная архитектура

**Плюсы:**

- Масштабирование отдельных сервисов.
- Независимая разработка.
- Высокая отказоустойчивость.
- Поддержка разных технологий.

**Минусы:**

- Сложное управление.
- Повышенные накладные расходы.
- Сложный мониторинг.
- Управление распределёнными транзакциями.

## Ключевые вопросы

#### 1. Что такое микросервисная архитектура?

Микросервисная архитектура — это подход, при котором приложение делится на независимые сервисы, выполняющие одну конкретную задачу. Они общаются через API (REST, gRPC) или очереди сообщений (Kafka, RabbitMQ).

#### 2. Что такое RPS (Requests per Second)?

RPS — это количество запросов, обрабатываемых системой за одну секунду. Этот показатель помогает оценить производительность и выявить узкие места в системе.

#### 3. Чем отличается микросервис от монолита?

- **Монолит:** Единое приложение с общей кодовой базой, развертывается и обновляется целиком.
- **Микросервис:** Состоит из отдельных сервисов, которые развёртываются, обновляются и масштабируются независимо.

#### 4. Опишите плюсы и минусы микросервисной архитектуры.

**Плюсы:**

- Масштабирование и отказоустойчивость.
- Независимый деплой.
- Гибкость разработки.

**Минусы:**

- Сложное управление и DevOps.
- Задержки из-за сетевых вызовов.
- Сложность мониторинга и логирования.

#### 5. Опишите плюсы и минусы монолита.

**Плюсы:**

- Простая архитектура.
- Быстрый старт разработки.
- Легкий CI/CD.

**Минусы:**

- Сложное масштабирование.
- Высокая связанность модулей.
- Один сбой ломает всё приложение.
