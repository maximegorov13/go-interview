# Репликация, шардирование и партиционирование

## Репликация

**Репликация** — это процесс копирования данных с одного сервера (мастера) на другой (реплику/слейв) для обеспечения отказоустойчивости, повышения доступности и масштабируемости.

### Основные виды

- **Горячая репликация (Hot Standby)** — реплика доступна для чтения.
- **Горизонтальная репликация** — данные копируются на одинаковые узлы.
- **Мастер-слейв** — один узел принимает запись, другие — только чтение.
- **Мастер-мастер** — оба узла могут принимать запись.

### Примеры

- **PostgreSQL**: Streaming Replication, Logical Replication.
- **MySQL**: Binary Log Replication.
- **MongoDB**: Replica Sets.

## Шардирование

**Шардирование** — это метод разделения данных на **разные узлы (шарды)** по горизонтали. Каждый шард содержит **часть** данных, но не все.

### Основные принципы

- **Горизонтальное разделение** — строки таблицы распределяются по разным узлам.
- **Ключ шардирования** — поле, по которому определяется, на какой шард отправлять данные.
- **Балансировка** — равномерное распределение нагрузки между шардами.

### Преимущества

- Повышение производительности.
- Масштабируемость.
- Параллельная обработка запросов.

### Примеры

- **MongoDB**: поддержка шардирования "из коробки".
- **PostgreSQL**: через расширения (например, Citus).
- **Redis**: Cluster Mode.

## Партиционирование

**Партиционирование** — это **логическое** разделение **одной таблицы** на **несколько частей** (партиций) внутри **одной БД**. Используется для оптимизации запросов и управления данными.

### Основные виды

- **Range Partitioning** — по диапазону значений (например, по дате).
- **List Partitioning** — по списку значений.
- **Hash Partitioning** — по хешу ключа.
- **Composite Partitioning** — комбинация нескольких типов.

### Пример в PostgreSQL

```sql
CREATE TABLE logs (
    log_id SERIAL,
    log_date DATE,
    message TEXT
) PARTITION BY RANGE (log_date);

CREATE TABLE logs_2025_01 PARTITION OF logs
    FOR VALUES FROM ('2025-01-01') TO ('2025-02-01');
```

**Преимущества**:

- Ускорение запросов.
- Легкость архивирования/удаления старых данных.
- Упрощение обслуживания таблиц.

## Характеристики

|                    | Репликация           | Шардирование         | Партиционирование    |
| ------------------ | -------------------- | -------------------- | -------------------- |
| Уровень разделения | Уровень базы/сервера | Уровень базы/таблицы | Уровень таблицы      |
| Масштабируемость   | Нет                  | Да                   | Нет                  |
| Сложность          | Низкая               | Высокая              | Средняя              |
| Используется для   | Отказоустойчивость   | Масштабирование      | Оптимизация запросов |
| Примеры            | Master-Slave         | MongoDB, Citus       | PostgreSQL, Oracle   |
